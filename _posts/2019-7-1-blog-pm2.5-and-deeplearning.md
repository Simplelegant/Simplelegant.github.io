---
layout:     post
title:      "当PM2.5预测遇到深度学习"
subtitle:   ""
date:       2019-7-1 13:28:04
author:     "Simpleelegant"
header-img: "img/post-bg-newstart.jpg"
tags:
    - 深度学习
---

#< center>当PM2.5预测遇到深度学习< /center>
<br>
听到人工智能的概念很久了，还记得小时候最喜欢看的就是科幻电影，作为一名程序员，一直想了解一下AI到底是个什么东东，于是研一下学期投入了深度学习的怀抱。
在看了一些相关的书记、学习了吴恩达的《机器学习课程》以及把玩儿了一段时间的Caffe和TensorFlow后，终于开始了自己的第一个深度学习项目实践~PM2.5预测！
为什么要搞这个项目呢~因为好胖友是搞测绘的刚好有很多很大的数据哈哈。他那儿卫星的参数有四个：AOD、时间、经度、纬度；气象参数有七个：表面压力、扰动气压、温度、水平风速、垂直风速、大气边界层高度、相对湿度；辅助参数有三个：人口、LUCC、DEM；加上地面PM2.5浓度数据，可以得到290900621（每小时有761*1121个数据，每天11个小时，31天）行、15列数据，然后将前14个参数中任意一个参数含有NaN的行删除掉，结果得到5727224行、15列数据，此数据集为最后需要预测的数据集；然后，删除对应地面站点值为NaN的行，得到30446行、列数据，此数据集即为训练集。可以看到，训练集和预测集差了188倍。
通过上面得到的训练集，采用交叉验证(Cross Validation)的思想，将数据随机划分为10份，其中9份用来训练，1份用来验证。
![training](./img/blog-deeplearning-2.png"训练过程")
将上述做好的训练集数据使用DNN模型进行建模，对于DNN，本项目使用的是基于Python的TensorFlow GPU版深度学习库，由于其计算开销比较大，经过多次实验，最终设置了10层隐含层，其中第一、二、三的神经元数量为256个，第三层到第十层的神经元数量为128个，迭代次数为20000次，初始学习率设置为一个固定值，每2000次衰减为其的0.96倍，Dropout参数设置为0.85，这意味着每一次迭代，都有15%的神经元被舍弃。经过计算，最终得到了在验证集上表现最佳的2016年1月全中国区域，AOD-PM2.5估算模型。
![training](./img/blog-deeplearning-1.png"训练参数")